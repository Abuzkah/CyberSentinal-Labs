import os
import re

XSS_PATTERN = re.compile(r'<script.*?>', re.IGNORECASE)
WEAK_HEADER_PATTERN = re.compile(r'<meta[^>]*http-equiv=["\']?X-UA-Compatible["\']?', re.IGNORECASE)


def scan_file(filepath):
    issues = []
    with open(filepath, 'r', encoding='utf-8', errors='ignore') as f:
        content = f.read()
        if XSS_PATTERN.search(content):
            issues.append('Possible XSS (script tag)')
        if WEAK_HEADER_PATTERN.search(content):
            issues.append('Weak header (X-UA-Compatible)')
    return issues

def crawl_folder(folder):
    results = {}
    for root, _, files in os.walk(folder):
        for file in files:
            if file.endswith('.html'):
                path = os.path.join(root, file)
                issues = scan_file(path)
                if issues:
                    results[path] = issues
    return results

def main():
    folder = input("Enter path to local website folder: ")
    results = crawl_folder(folder)
    if not results:
        print("No issues found.")
    else:
        for file, issues in results.items():
            print(f"\n{file}:")
            for issue in issues:
                print(f"  - {issue}")

if __name__ == "__main__":
    main()
